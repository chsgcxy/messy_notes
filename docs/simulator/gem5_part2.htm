<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Microsoft PowerPoint - gem5_cix_ch_part2</title><meta name="author" content="chenhao"/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 h1 { color: #1A5493; font-family:Calibri, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 40pt; }
 h3 { color: #1A5493; font-family:等线; font-style: normal; font-weight: bold; text-decoration: none; font-size: 21pt; }
 .s1 { color: #1A5493; font-family:"等线 Light"; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 .s2 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 17.5pt; }
 .s3 { color: #212428; font-family:"Arial Unicode MS", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15.5pt; }
 .s4 { color: #212428; font-family:"Arial Unicode MS", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s5 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s6 { color: #0562C1; font-family:"Arial Unicode MS", sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 10.5pt; }
 .s7 { color: #0562C1; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 9.5pt; }
 .s8 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 21pt; }
 .s9 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15.5pt; }
 .s10 { color: #F00; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s11 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9.5pt; }
 .s12 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s14 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 p { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; margin:0pt; }
 .s15 { color: #F00; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s17 { color: #0562C1; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 15.5pt; }
 .s18 { color: #0562C1; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15.5pt; }
 .s21 { color: #AAB1BF; font-family:Consolas, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9.5pt; }
 .s22 { color: #D19A66; font-family:Consolas, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9.5pt; }
 .s23 { color: #C677DD; font-family:Consolas, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s26 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 .s27 { color: #F00; font-family:"Arial Unicode MS", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9.5pt; }
 .s28 { color: #F00; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9.5pt; }
 h2 { color: #1A5493; font-family:等线; font-style: normal; font-weight: bold; text-decoration: none; font-size: 31.5pt; }
 .s29 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 42pt; }
 li {display: block; }
 #l1 {padding-left: 0pt; }
 #l1> li>*:first-child:before {content: " "; color: black; font-family:Wingdings; font-style: normal; font-weight: normal; text-decoration: none; font-size: 17.5pt; }
 li {display: block; }
 #l2 {padding-left: 0pt; }
 #l2> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; }
 #l3 {padding-left: 0pt; }
 #l3> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; }
 #l4 {padding-left: 0pt; }
 #l4> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; }
 #l5 {padding-left: 0pt; }
 #l5> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8.5pt; }
 #l6 {padding-left: 0pt; }
 #l6> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; }
 #l7 {padding-left: 0pt; }
 #l7> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; }
</style></head><body><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-left: 389pt;text-indent: 0pt;line-height: 46pt;text-align: left;">Gem5     part2</h1><h3 style="padding-top: 10pt;padding-left: 389pt;text-indent: 0pt;line-height: 72%;text-align: left;">A Modular platform for computer-system architecture research</h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s1" style="padding-top: 1pt;padding-left: 17pt;text-indent: 0pt;text-align: center;">chsgcxy</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ul id="l1"><li><p class="s2" style="padding-top: 4pt;padding-left: 77pt;text-indent: -19pt;line-height: 21pt;text-align: left;">Ruby memory sub-system</p></li><li><p class="s2" style="padding-left: 77pt;text-indent: -19pt;line-height: 21pt;text-align: left;">Power and thermal model</p></li><li><p class="s2" style="padding-left: 77pt;text-indent: -19pt;line-height: 21pt;text-align: left;">GPU</p></li></ul><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Ruby implements a detailed simulation model for the memory subsystem</p><ul id="l2"><li><p class="s4" style="padding-top: 5pt;padding-left: 48pt;text-indent: -19pt;line-height: 15pt;text-align: left;">Inclusive/exclusive cache hierarchies</p></li><li><p class="s4" style="padding-left: 48pt;text-indent: -19pt;line-height: 13pt;text-align: left;">Various replacement policies</p></li><li><p class="s4" style="padding-left: 48pt;text-indent: -19pt;line-height: 13pt;text-align: left;">Coherence protocol implementations</p></li><li><p class="s4" style="padding-left: 48pt;text-indent: -19pt;line-height: 13pt;text-align: left;">Interconnection networks</p></li><li><p class="s4" style="padding-left: 48pt;text-indent: -19pt;line-height: 13pt;text-align: left;">DMA and memory controllers</p><p style="text-indent: 0pt;text-align: left;"><span><img width="531" height="196" alt="image" src="gem5_part2_files/Image_001.jpg"/></span></p></li><li><p class="s4" style="padding-left: 48pt;text-indent: -19pt;line-height: 15pt;text-align: left;">Various sequencers</p></li><li><p class="s5" style="padding-top: 8pt;padding-left: 37pt;text-indent: -11pt;line-height: 13pt;text-align: left;">NetWork</p><ul id="l3"><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">GarnetNetWork</p></li><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">SimpleNetWork</p></li></ul></li><li><p class="s5" style="padding-left: 37pt;text-indent: -11pt;line-height: 13pt;text-align: left;">Protocol</p><ul id="l4"><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">MI_example</p></li><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">MESI_Two_level</p></li><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">MOESI_CMP_directory</p></li><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">MOESI_CMP_token</p></li><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">MOESI_hammer</p></li><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">Garnet_standalone</p></li><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">MESI_Three_Level</p></li><li><p class="s5" style="padding-left: 68pt;text-indent: -11pt;line-height: 13pt;text-align: left;">CHI</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-top: 11pt;padding-left: 23pt;text-indent: 0pt;line-height: 15pt;text-align: left;">Interconnection network could be replaced with the external simulator <span class="s6">TOPAZ</span>.</p><p class="s4" style="padding-left: 20pt;text-indent: 0pt;line-height: 13pt;text-align: left;">This simulator is ready to run within gem5 and adds a significant number of features over original ruby network simulator.</p><p class="s4" style="padding-top: 1pt;padding-left: 20pt;text-indent: 0pt;line-height: 69%;text-align: left;">It includes, new advanced router micro-architectures, new topologies, precision-performance adjustable router models, mechanisms to speed-up network simulation, etc</p><p class="s7" style="padding-top: 3pt;padding-left: 20pt;text-indent: 0pt;text-align: left;">ceunican/tpzsimul: Automatically exported from code.google.com/p/tpzsimul (github.com)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s8" style="padding-left: 17pt;text-indent: 0pt;text-align: center;">Topology</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 146pt;text-indent: 0pt;text-align: left;"><span><img width="710" height="404" alt="image" src="gem5_part2_files/Image_002.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 1pt;text-indent: 0pt;line-height: 17pt;text-align: left;">PROTOCOL</p><p style="text-indent: 0pt;text-align: left;"/><p class="s5" style="padding-left: 12pt;text-indent: 0pt;text-align: left;">scons build/ARM/gem5.debug PROTOCOL=CHI</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="padding-top: 7pt;padding-left: 36pt;text-indent: 0pt;text-align: left;">*CHI only support CustomMesh topology</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">Run an example</p><p class="s8" style="padding-left: 23pt;text-indent: 0pt;text-align: left;">CHI</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="367" height="325" alt="image" src="gem5_part2_files/Image_003.jpg"/></span></p><p class="s12" style="padding-top: 2pt;padding-left: 8pt;text-indent: -2pt;text-align: left;">./build/<span style=" color: #F00;">ARM</span>/gem5.debug configs/example/se.py</p><p class="s12" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">--cpu-type=ArmO3CPU</p><p class="s12" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">--caches --l2cache --mem-type=DDR4_2400_8x8</p><p class="s12" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">--mem-size=2GB --l1d_size=64kB --l1i_size=32kB</p><p class="s12" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">--l2_size=512kB -n 4 <span style=" color: #F00;">--ruby</span></p><p class="s12" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">--topology=<span style=" color: #F00;">CustomMesh</span></p><p class="s12" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">--chi-config=configs/example/noc_config/<span style=" color: #F00;">2x4.py</span></p><p class="s12" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">-c tests/test-progs/threads/src/threads</p><p style="text-indent: 0pt;text-align: left;"/><ul id="l5"><li><p class="s14" style="padding-top: 3pt;padding-left: 17pt;text-indent: -11pt;text-align: left;">MI_example</p></li><li><p class="s14" style="padding-left: 17pt;text-indent: -11pt;text-align: left;">MESI_Two_level</p></li><li><p class="s14" style="padding-left: 17pt;text-indent: -11pt;text-align: left;">MOESI_CMP_directory</p></li><li><p class="s14" style="padding-left: 17pt;text-indent: -11pt;text-align: left;">MOESI_CMP_token</p></li><li><p class="s14" style="padding-left: 17pt;text-indent: -11pt;text-align: left;">MOESI_hammer</p></li><li><p class="s14" style="padding-left: 17pt;text-indent: -11pt;text-align: left;">Garnet_standalone</p></li><li><p class="s14" style="padding-left: 17pt;text-indent: -11pt;text-align: left;">MESI_Three_Level</p></li><li><p class="s14" style="padding-left: 17pt;text-indent: -11pt;text-align: left;">CHI</p></li></ul><p style="text-indent: 0pt;text-align: left;"/><p class="s5" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">Topology dot file</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-bottom: 3pt;padding-left: 18pt;text-indent: 0pt;text-align: left;">2x4.py</p><p style="padding-left: 11pt;text-indent: 0pt;text-align: left;"><span><img width="437" height="399" alt="image" src="gem5_part2_files/Image_004.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s8" style="padding-left: 17pt;text-indent: 0pt;text-align: center;">CHI 2x4 Connected by link</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1073" height="450" alt="image" src="gem5_part2_files/Image_005.jpg"/></span></p><p style="padding-top: 2pt;padding-left: 17pt;text-indent: 0pt;text-align: center;">src/python/m5/util/dot_writer_ruby.py</p><p class="s15" style="padding-top: 6pt;padding-left: 17pt;text-indent: 0pt;text-align: center;">Need to rebuild when change the file</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s8" style="text-indent: 0pt;text-align: right;">Garnet Router</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="454" height="394" alt="image" src="gem5_part2_files/Image_006.jpg"/></span></p><p class="s9" style="padding-top: 13pt;padding-left: 103pt;text-indent: 0pt;text-align: left;">credit</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li><p class="s9" style="padding-top: 4pt;padding-left: 46pt;text-indent: -23pt;text-align: left;">Gem5 power consumption model:</p><p style="padding-top: 1pt;padding-left: 22pt;text-indent: 12pt;text-align: left;">gem5 itself cannot provide complete power information. Although the power consumption model of the memory part is relatively complete, it lacks a more accurate CPU power consumption model.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ul id="l6"><li><p style="padding-left: 73pt;text-indent: -19pt;text-align: left;">configs/example/arm/fs_power.py</p></li><li><p style="padding-left: 73pt;text-indent: -19pt;text-align: left;">support ARM DVFS</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li><p class="s9" style="padding-left: 42pt;text-indent: -19pt;text-align: left;">Gem5 stat.txt + mcpat</p><p style="padding-top: 3pt;padding-left: 22pt;text-indent: 14pt;text-align: left;">Although there are some third-party tools that can calculate detailed energy consumption information based on the output of gem5 simulator, such as <span style=" color: #F00;">mcpat</span>, etc., studies have shown that the calculation results of these tools have a large error with the results obtained by hardware measuring instruments</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="183" height="179" alt="image" src="gem5_part2_files/Image_007.jpg"/></span></p><ul id="l7"><li><p style="padding-left: 73pt;text-indent: -19pt;text-align: left;">ext/mcpat</p></li></ul></li></ul><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 486pt;text-indent: 0pt;line-height: 134%;text-align: left;">gem5: ARM Power Modelling<span class="s18"> </span>gem5: ARM DVFS Support</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 6pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">src/arch/amdgpu/</p><p style="padding-left: 492pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span><img width="586" height="151" alt="image" src="gem5_part2_files/Image_008.png"/></span></p><p class="s21" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #C677DD;">def </span><span style=" color: #60AFEF;">connectGPU</span>(<span style=" color: #D19A66;">system</span>, <span style=" color: #D19A66;">args</span>):</p><p class="s22" style="padding-left: 27pt;text-indent: 0pt;text-align: left;"><span style=" color: #AAB1BF;">system.pc.south_bridge.gpu </span><span style=" color: #C677DD;">= </span><span style=" color: #AAB1BF;">AMDGPUDevice(</span>pci_func<span style=" color: #C677DD;">=</span>0<span style=" color: #AAB1BF;">, </span>pci_dev<span style=" color: #C677DD;">=</span>8<span style=" color: #AAB1BF;">, </span>pci_bus<span style=" color: #C677DD;">=</span>0<span style=" color: #AAB1BF;">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s21" style="padding-left: 27pt;text-indent: 0pt;text-align: left;">system.pc.south_bridge.gpu.trace_file <span style=" color: #C677DD;">= </span>args.gpu_mmio_trace system.pc.south_bridge.gpu.rom_binary <span style=" color: #C677DD;">= </span>args.gpu_rom system.pc.south_bridge.gpu.checkpoint_before_mmios <span style=" color: #C677DD;">= </span>\</p><p class="s21" style="padding-left: 48pt;text-indent: 0pt;line-height: 11pt;text-align: left;">args.checkpoint_before_mmios</p><p style="text-indent: 0pt;text-align: left;"/><p class="s23" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">class <span style=" color: #E4BF7B;">AMDGPUDevice </span><span style=" color: #AAB1BF;">: </span>public <span style=" color: #E4BF7B;">PciDevice</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s26" style="text-indent: 0pt;line-height: 17pt;text-align: right;">Only support AMD GPU</p><p class="s14" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">define gpu instructions</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 260pt;text-indent: 0pt;line-height: 5pt;text-align: left;"><span><img width="95" height="7" alt="image" src="gem5_part2_files/Image_009.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-top: 5pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">AMD vega/gcn3</p><p style="text-indent: 0pt;text-align: left;"/><p class="s9" style="padding-top: 5pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">X86 CPU</p><p style="text-indent: 0pt;text-align: left;"/><p class="s12" style="text-indent: 0pt;text-align: right;">Only se mode</p><p class="s5" style="padding-left: 51pt;text-indent: 0pt;text-align: left;">PCIE</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 6pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">src/dev/amdgpu/</p><p style="text-indent: 0pt;text-align: left;"/><p class="s14" style="padding-top: 6pt;padding-left: 17pt;text-indent: 0pt;text-align: center;">define gpu device</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 6pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">src/dev/gpu-compute/</p><p style="padding-left: 492pt;text-indent: 0pt;text-align: left;"/><p class="s14" style="padding-top: 4pt;padding-left: 518pt;text-indent: 0pt;text-align: left;">gpu micro architecture</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s27" style="padding-top: 7pt;padding-left: 179pt;text-indent: 0pt;line-height: 70%;text-align: left;">a Docker image that contains the proper software and libraries needed to run the GPU model in gem5 Reference: <span class="s28">util/dockerfiles/gcn-gpu/README.md</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 59pt;text-indent: 0pt;line-height: 45pt;text-align: left;">QA</h2><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s29" style="padding-left: 17pt;text-indent: 0pt;line-height: 48pt;text-align: center;">Thanks</p></body></html>
